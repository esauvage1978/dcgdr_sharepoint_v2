{% macro backpack(twigTemplace,currentState,owner,item,underRubric,visible,hide) %}
    {% import "macros/widgets.html.twig" as widgets %}
    {% import "macros/delele.html.twig" as del %}
    {% set actions = {} %}
    {% if underRubric %}
        {% set actions = actions|merge({ 'left': {url: path('rubric_show',{id:underRubric.rubric.id}),class:'btn-secondary',attr:{title:'retour'}}}) %}
    {% endif %}
    {% set actions = actions|merge({ 'home': {url: path('home'),class:'btn-secondary',attr:{title:'Accueil'}}}) %}
    {% set actions = actions|merge({'divider': null}) %}


    {% if item %}

        {% set actions = actions|merge({ 'comment': {url: path('comment',{id:item.id}),class:'btn-secondary',attr:{title:'Commenter'}}}) %}
        {% if item.comments | length >0  %}
            {% set actions = actions|merge({ 'comments': {url: path('comments',{id:item.id}),title:item.comments | length,class:'btn-secondary',attr:{title:'Nombre de commentaires'}}}) %}
        {% endif %}
        {% set actions = actions|merge({'divider2': null}) %}

        {% if hide %}
            {% set url=path('backpacks_hide',{iditem:item}) %}
        {% elseif underRubric and currentState=='published' %}
            {% set url=path('underrubric_show',{visible:'true',id:underRubric.id,idItem:item.id}) %}
        {% else %}
            {% set url=path('backpacks',{visible:'true',currentState:currentState,idItem:item.id}) %}
        {% endif %}

        {% if twigTemplace=='tree' %}
            {% if  item | backpackCanUpdate %}
                {% set actions = actions|merge({ 'edit': {url: path('backpack_edit',{id:item.id}),class:'btn-secondary',attr:{title:'Modifier'}}}) %}
            {% endif %}
            {% if  item | backpackCanDelete %}
                {% set actions = actions|merge({ 'delete': {onclick: '$(\'#delete_1\').click();',class:'btn-danger',attr:{title:'Supprimer'}}}) %}
                {{ del.delete_form('backpack_del',item.id, null) }}
            {% endif %}
        {% elseif twigTemplace=='comment_add' or twigTemplace=='comments' %}
            {% if  item | backpackCanUpdate %}
                {% set actions = actions|merge({ 'edit': {url: path('backpack_edit',{id:item.id}),class:'btn-secondary',attr:{title:'Modifier'}}}) %}
            {% endif %}
            {% set actions = actions|merge({ 'save': {onclick: '$(\'#submit_1\').click();',class:'btn-success',attr:{title:'Sauvegarder'}}}) %}

        {% elseif twigTemplace=='workflow' %}
            {% set actions = actions|merge({ 'show': {url: url,class:'btn-secondary',attr:{title:'Consulter'}}}) %}
            {% set actions = actions|merge({ 'edit': {url: path('backpack_edit',{id:item.id}),class:'btn-secondary',attr:{title:'Modifier'}}}) %}
        {% elseif twigTemplace=='history' %}
            {% set actions = actions|merge({ 'show': {url: url,class:'btn-secondary',attr:{title:'Consulter'}}}) %}
            {% if  item | backpackCanDelete %}
                {% set actions = actions|merge({ 'delete': {onclick: '$(\'#delete_1\').click();',class:'btn-danger',attr:{title:'Supprimer'}}}) %}
                {{ del.delete_form('backpack_del',item.id, null) }}
            {% endif %}
            {% set actions = actions|merge({ 'edit': {url: path('backpack_edit',{id:item.id}),class:'btn-secondary',attr:{title:'Modifier'}}}) %}
        {% elseif twigTemplace=='edit' %}
            {% set actions = actions|merge({ 'workflow': {url: path('workflow_backpack_history',{id:item.id}),class:'btn-secondary',attr:{title:'historique du workflow'}}}) %}
            {% set actions = actions|merge({ 'history': {url: path('backpack_history',{id:item.id}),class:'btn-secondary',attr:{title:'historique des modifications'}}}) %}
            {% set actions = actions|merge({ 'show': {url: url,class:'btn-secondary',attr:{title:'Consulter'}}}) %}
            {% if  item | backpackCanDelete %}
                {% set actions = actions|merge({ 'delete': {onclick: '$(\'#delete_1\').click();',class:'btn-danger',attr:{title:'Supprimer'}}}) %}
                {{ del.delete_form('backpack_del',item.id, null) }}
            {% endif %}
            {% set actions = actions|merge({ 'save': {onclick: '$(\'#submit_1\').click();',class:'btn-success',attr:{title:'Sauvegarder'}}}) %}
        {% endif %}
    {% elseif twigTemplace=='add' %}
        {% set actions = actions|merge({ 'save': {onclick: '$(\'#submit_1\').click();',class:'btn-success',attr:{title:'Sauvegarder'}}}) %}
    {% endif %}
    {{ widgets.page_actions(actions) }}
{% endmacro %}